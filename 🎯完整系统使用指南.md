# 🎯 银行代码检索系统 - 完整使用指南

**系统版本**: v1.0.0  
**更新时间**: 2026-01-12  
**状态**: ✅ 完整可用

---

## 📋 目录

1. [系统概述](#系统概述)
2. [快速开始](#快速开始)
3. [功能详解](#功能详解)
4. [常见问题](#常见问题)
5. [技术支持](#技术支持)

---

## 系统概述

### 系统简介
银行代码检索系统是一个基于AI的智能问答平台，用于快速检索和查询银行代码信息。

### 核心功能
- 📊 **数据管理** - 上传和管理银行代码数据集
- 🚀 **模型训练** - 训练定制化的AI模型
- 🤖 **智能问答** - 自然语言查询银行代码
- 👥 **用户管理** - 管理系统用户和权限
- ⚙️ **系统设置** - 查看日志和系统信息

### 技术架构
- **前端**: React + TypeScript + Ant Design
- **后端**: FastAPI + Python
- **数据库**: SQLite
- **AI模型**: 基于LoRA的微调模型

---

## 快速开始

### 1. 访问系统

**前端地址**: http://localhost:3000  
**后端API**: http://localhost:8000  
**API文档**: http://localhost:8000/docs

### 2. 登录系统

**测试账号**:
- 用户名: `testuser`
- 密码: `test123456`
- 角色: 普通用户

**管理员账号**（如需创建）:
```bash
python3 create_test_user.py
```

### 3. 首次使用流程

#### 步骤1：上传数据集
1. 点击左侧菜单 **"数据管理"**
2. 点击 **"上传数据集"** 按钮
3. 选择CSV或Excel文件
4. 点击 **"上传"**
5. 等待上传完成

#### 步骤2：验证数据
1. 在数据集列表中找到刚上传的数据
2. 点击 **"验证"** 按钮
3. 等待验证完成
4. 查看验证结果

#### 步骤3：创建训练任务
1. 点击左侧菜单 **"训练管理"**
2. 点击 **"创建训练任务"** 按钮
3. 选择数据集
4. 输入模型名称
5. 配置训练参数：
   - LoRA Rank: 8（推荐）
   - 学习率: 0.0001（推荐）
   - 训练轮数: 3（推荐）
   - 批次大小: 4（推荐）
6. 点击 **"创建"**
7. 等待训练完成（可在列表中查看进度）

#### 步骤4：开始问答
1. 点击左侧菜单 **"智能问答"**
2. 在输入框中输入问题，例如：
   - "中国银行的银行代码是什么？"
   - "工商银行的SWIFT代码"
   - "查询建设银行的信息"
3. 确保RAG开关已开启（推荐）
4. 点击 **"提问"** 或按回车键
5. 查看AI回答和参考文档

---

## 功能详解

### 1. 仪表盘（Dashboard）

**路径**: `/dashboard`

**功能说明**:
- 显示系统概览统计
- 查看最近训练任务
- 查看最近查询记录
- 快捷操作入口

**使用技巧**:
- 点击统计卡片可快速跳转到对应页面
- 使用快捷操作按钮快速开始工作

---

### 2. 数据管理（Data Management）

**路径**: `/data`

#### 2.1 上传数据集

**支持格式**:
- CSV文件（.csv）
- Excel文件（.xlsx, .xls）

**数据格式要求**:
- 必须包含银行代码相关字段
- 建议包含：银行名称、银行代码、SWIFT代码等
- 数据应清洗干净，无重复和错误

**操作步骤**:
1. 点击 **"上传数据集"**
2. 选择文件
3. 点击 **"上传"**
4. 等待处理完成

#### 2.2 查看数据集详情

**操作步骤**:
1. 在列表中找到数据集
2. 点击 **"详情"** 按钮
3. 查看统计信息：
   - 总记录数
   - 唯一银行代码数
   - 唯一银行名称数
   - 数据质量分数

#### 2.3 预览数据

**操作步骤**:
1. 点击 **"预览"** 按钮
2. 查看前20条数据
3. 检查数据格式是否正确

#### 2.4 验证数据集

**操作步骤**:
1. 点击 **"验证"** 按钮
2. 系统自动检查数据格式
3. 查看验证结果

**验证内容**:
- 数据格式是否正确
- 必填字段是否完整
- 数据类型是否匹配
- 是否有重复数据

---

### 3. 训练管理（Training Management）

**路径**: `/training`

#### 3.1 创建训练任务

**参数说明**:

| 参数 | 说明 | 推荐值 | 范围 |
|------|------|--------|------|
| 数据集 | 用于训练的数据集 | 已验证的数据集 | - |
| 模型名称 | 模型的唯一标识 | bank-code-model-v1 | - |
| LoRA Rank | 适配器的秩 | 8 | 1-64 |
| 学习率 | 训练步长 | 0.0001 | 0.00001-0.01 |
| 训练轮数 | 完整遍历数据次数 | 3 | 1-100 |
| 批次大小 | 每批样本数量 | 4 | 1-32 |

**操作步骤**:
1. 点击 **"创建训练任务"**
2. 选择数据集
3. 输入模型名称
4. 配置训练参数
5. 点击 **"创建"**

#### 3.2 监控训练进度

**查看内容**:
- 训练状态（pending/running/completed/failed/stopped）
- 进度百分比
- 当前轮次
- 当前Loss值
- 预计完成时间

**操作**:
- 自动刷新：每10秒自动更新
- 手动刷新：点击 **"刷新"** 按钮
- 查看详情：点击 **"详情"** 查看完整信息
- 停止训练：点击 **"停止"** 终止运行中的任务

#### 3.3 训练状态说明

| 状态 | 说明 | 颜色 |
|------|------|------|
| pending | 等待开始 | 灰色 |
| running | 训练中 | 蓝色 |
| completed | 已完成 | 绿色 |
| failed | 失败 | 红色 |
| stopped | 已停止 | 橙色 |

---

### 4. 模型管理（Model Management）

**路径**: `/models`

#### 4.1 查看模型列表

**显示内容**:
- 已完成训练的模型
- 训练参数
- 最终Loss值
- 完成时间

#### 4.2 启动评估

**评估类型**:
- **准确率评估**: 测试模型回答的准确性
- **性能评估**: 测试模型的响应速度
- **综合评估**: 全面评估模型性能

**操作步骤**:
1. 选择模型
2. 点击 **"评估"** 按钮
3. 选择评估类型
4. 选择测试数据集（可选）
5. 点击 **"启动"**

#### 4.3 查看评估结果

**查看内容**:
- 评估状态
- 准确率
- 响应时间
- 详细报告

---

### 5. 智能问答（QA Interface）

**路径**: `/qa`

#### 5.1 提问方式

**输入问题**:
- 在文本框中输入问题
- 支持中文自然语言
- 最多500字符

**提交方式**:
- 点击 **"提问"** 按钮
- 按 **Enter** 键（Shift+Enter换行）

#### 5.2 RAG开关

**RAG（检索增强生成）**:
- **开启**: 使用知识库检索增强回答（推荐）
- **关闭**: 仅使用模型直接回答

**建议**:
- 查询具体信息时：开启RAG
- 测试模型能力时：关闭RAG

#### 5.3 查看答案

**显示内容**:
- AI生成的答案
- 响应时间（毫秒）
- 置信度（如有）
- 检索模式标签
- 参考文档（RAG模式）

#### 5.4 查询历史

**功能**:
- 查看最近50条查询记录
- 点击历史记录回填问题
- 查看历史答案

**显示信息**:
- 问题内容
- 答案摘要
- 查询时间
- 响应时间
- RAG标签

#### 5.5 问题示例

**银行代码查询**:
- "中国银行的银行代码是什么？"
- "查询工商银行的SWIFT代码"
- "建设银行的联行号"

**银行信息查询**:
- "中国有哪些国有银行？"
- "招商银行的总部在哪里？"
- "农业银行的英文名称"

**对比查询**:
- "中国银行和中国工商银行有什么区别？"
- "比较四大行的银行代码"

---

### 6. 用户管理（User Management）

**路径**: `/users`  
**权限**: 仅管理员可访问

#### 6.1 查看用户列表

**显示内容**:
- 用户ID
- 用户名
- 邮箱
- 角色（管理员/普通用户）
- 状态（激活/禁用）
- 创建时间

#### 6.2 查看用户详情

**操作步骤**:
1. 点击 **"详情"** 按钮
2. 查看完整用户信息

#### 6.3 删除用户

**操作步骤**:
1. 点击 **"删除"** 按钮
2. 确认删除操作
3. 等待删除完成

**注意事项**:
- 不能删除管理员账户
- 删除操作不可恢复
- 需要二次确认

---

### 7. 系统设置（System Settings）

**路径**: `/settings`  
**权限**: 仅管理员可访问

#### 7.1 查看系统日志

**日志级别**:
- DEBUG: 调试信息
- INFO: 一般信息
- WARNING: 警告信息
- ERROR: 错误信息
- CRITICAL: 严重错误

**筛选功能**:
- 按日志级别筛选
- 分页显示（每页50条）

#### 7.2 日志文件列表

**功能**:
- 查看所有日志文件
- 按时间排序

#### 7.3 系统信息

**显示内容**:
- 应用名称
- 版本号
- 后端框架
- 前端框架

---

## 常见问题

### Q1: 上传数据集失败怎么办？

**可能原因**:
1. 文件格式不支持
2. 文件大小超限
3. 数据格式不正确

**解决方案**:
1. 确认文件是CSV或Excel格式
2. 检查文件大小（建议<100MB）
3. 检查数据格式是否符合要求
4. 查看错误提示信息

### Q2: 训练任务一直pending怎么办？

**可能原因**:
1. 系统资源不足
2. 数据集未验证
3. 参数配置错误

**解决方案**:
1. 检查系统资源使用情况
2. 先验证数据集
3. 检查训练参数是否合理
4. 查看后端日志

### Q3: 问答没有返回结果怎么办？

**可能原因**:
1. 没有训练完成的模型
2. 问题格式不正确
3. 网络连接问题

**解决方案**:
1. 确认至少有一个训练完成的模型
2. 使用清晰明确的问题
3. 检查网络连接
4. 查看错误提示

### Q4: 如何提高问答准确率？

**建议**:
1. 使用高质量的训练数据
2. 增加训练轮数
3. 开启RAG模式
4. 使用更大的数据集
5. 调整训练参数

### Q5: 忘记密码怎么办？

**解决方案**:
1. 联系管理员重置密码
2. 或使用创建用户脚本重新创建账户

---

## 技术支持

### 查看日志

**后端日志**:
```bash
tail -f mvp/backend.log
```

**前端日志**:
- 打开浏览器开发者工具（F12）
- 查看Console标签

### 重启服务

**重启后端**:
```bash
pkill -f "uvicorn app.main:app"
cd mvp
python3 -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

**重启前端**:
```bash
pkill -f "react-scripts"
cd frontend
npm start
```

### 清理数据

**清理数据库**:
```bash
rm mvp/*.db
# 然后重启后端，会自动创建新数据库
```

**清理上传文件**:
```bash
rm -rf data/uploads/*
```

### 联系方式

- **项目文档**: 查看项目根目录下的Markdown文件
- **API文档**: http://localhost:8000/docs
- **系统日志**: 系统设置页面

---

## 最佳实践

### 1. 数据准备
- 使用干净、准确的数据
- 数据量建议>1000条
- 定期更新数据集

### 2. 模型训练
- 首次训练使用默认参数
- 根据效果调整参数
- 保存训练记录

### 3. 问答使用
- 使用清晰明确的问题
- 开启RAG模式
- 查看参考文档

### 4. 系统维护
- 定期查看日志
- 监控系统资源
- 备份重要数据

---

## 附录

### A. 快捷键

| 快捷键 | 功能 |
|--------|------|
| Enter | 提交问题 |
| Shift+Enter | 换行 |
| F5 | 刷新页面 |
| F12 | 开发者工具 |

### B. 状态码说明

| 状态码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求错误 |
| 401 | 未认证 |
| 403 | 无权限 |
| 404 | 未找到 |
| 422 | 参数错误 |
| 500 | 服务器错误 |

### C. 文件格式要求

**CSV文件**:
```csv
bank_code,bank_name,swift_code
001,中国银行,BKCHCNBJ
002,工商银行,ICBKCNBJ
```

**Excel文件**:
- 第一行为表头
- 数据从第二行开始
- 支持.xlsx和.xls格式

---

**文档版本**: v1.0.0  
**最后更新**: 2026-01-12  
**维护者**: 系统管理员

🎉 **祝您使用愉快！** 🎉
