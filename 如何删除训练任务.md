# 如何删除训练任务

## 问题说明

由于后端API存在验证问题，网页上的删除功能目前只能临时从页面移除任务，刷新后会重新出现。

要永久删除训练任务，请使用以下方法：

## 方法1：使用删除脚本（推荐）

### 1. 查看所有训练任务

```bash
cd mvp
./venv/bin/python delete_training_jobs.py --list
```

### 2. 删除指定ID的任务

```bash
# 删除单个任务
./venv/bin/python delete_training_jobs.py --ids 17

# 删除多个任务
./venv/bin/python delete_training_jobs.py --ids 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17
```

### 3. 删除所有失败的任务

```bash
./venv/bin/python delete_training_jobs.py --all-failed
```

### 4. 删除所有已完成的任务

```bash
./venv/bin/python delete_training_jobs.py --all-completed
```

### 5. 根据状态删除

```bash
# 删除所有失败的任务
./venv/bin/python delete_training_jobs.py --status failed

# 删除所有已停止的任务
./venv/bin/python delete_training_jobs.py --status stopped
```

## 方法2：使用数据库工具

```bash
cd mvp
sqlite3 data/bank_code.db

# 查看所有训练任务
SELECT id, model_name, status, created_at FROM training_jobs ORDER BY created_at DESC;

# 删除指定ID的任务
DELETE FROM training_jobs WHERE id IN (1,2,3,4,5);

# 删除所有失败的任务
DELETE FROM training_jobs WHERE status = 'failed';

# 退出
.quit
```

## 示例：清理所有失败的任务

```bash
cd mvp

# 1. 先查看有哪些失败的任务
./venv/bin/python delete_training_jobs.py --list

# 2. 删除所有失败的任务
./venv/bin/python delete_training_jobs.py --all-failed

# 3. 刷新网页，确认任务已删除
```

## 注意事项

1. **删除操作不可恢复**：删除后无法恢复，请谨慎操作
2. **模型文件也会被删除**：脚本会自动删除相关的模型文件
3. **不能删除正在运行的任务**：请先停止任务再删除
4. **需要确认**：脚本会要求输入 `yes` 确认删除

## 网页功能说明

目前网页上的删除功能：
- ✅ 可以从页面移除任务（临时）
- ✅ 支持批量选择和删除
- ⚠️ 刷新页面后任务会重新出现
- ⚠️ 需要使用脚本才能永久删除

## 后续计划

我们正在修复后端API的验证问题，修复后网页删除功能将可以永久删除任务。
