# 🎯 大模型提示词管理使用指南

## 📖 功能介绍

大模型提示词管理功能允许您自定义和维护用于样本生成的LLM提示词模板。系统支持三个大模型提供商：
- **通义千问** (Qwen)
- **DeepSeek**
- **火山引擎** (Volces)

每个提供商支持四种问题类型的提示词：
- **精确查询** (exact): 使用完整银行名称查询联行号
- **模糊查询** (fuzzy): 使用简称或不完整名称查询
- **反向查询** (reverse): 根据联行号查询银行名称
- **自然语言** (natural): 口语化的自然语言表达

## 🚀 快速开始

### 1. 访问页面
1. 登录系统（管理员账号）
2. 点击左侧菜单「样本管理」
3. 点击子菜单「大模型提示词管理」

### 2. 初始化默认模板
首次使用时，需要初始化默认模板：
1. 点击页面右上角「初始化默认模板」按钮
2. 系统会自动创建12个默认提示词模板
3. 提示"成功初始化 12 个默认提示词模板"

### 3. 浏览提示词
- 使用顶部Tab切换不同提供商：
  - **全部**: 显示所有提示词
  - **通义千问**: 只显示通义千问的提示词
  - **DeepSeek**: 只显示DeepSeek的提示词
  - **火山引擎**: 只显示火山引擎的提示词

## 📝 主要功能

### 查看提示词详情
1. 在列表中找到要查看的提示词
2. 点击「查看」按钮
3. 弹出窗口显示：
   - 提供商和问题类型标签
   - 提示词描述
   - 完整的提示词模板内容
   - 创建和更新时间

### 编辑提示词
1. 点击「编辑」按钮
2. 在弹出窗口中修改：
   - **提示词模板**: 主要内容，支持变量
   - **描述**: 提示词的说明
   - **启用状态**: 开关控制是否启用
3. 点击「保存」按钮

#### 可用变量
在提示词模板中可以使用以下变量：
- `{bank_name}` - 银行名称
- `{bank_code}` - 联行号
- `{clearing_code}` - 清算行行号

#### 示例
```
请根据以下银行信息生成一个精确查询的问答对：
银行名称：{bank_name}
联行号：{bank_code}
清算行行号：{clearing_code}

要求：
1. 问题应该是完整的银行名称查询联行号
2. 答案应该直接给出联行号
3. 格式：问题|答案

请生成：
```

### 重置提示词
如果修改后效果不理想，可以重置为默认值：
1. 点击「重置」按钮
2. 确认操作
3. 提示词恢复为系统默认值

### 刷新列表
点击右上角「刷新」按钮，重新加载最新的提示词列表。

## 🎨 界面说明

### 状态标签
- **蓝色标签**: 通义千问提供商
- **绿色标签**: DeepSeek提供商
- **紫色标签**: 火山引擎提供商
- **金色标签**: 默认模板
- **绿色状态**: 已启用
- **红色状态**: 已禁用

### 表格列
- **LLM提供商**: 显示提供商名称和颜色标签
- **问题类型**: 显示问题类型（精确/模糊/反向/自然语言）
- **提示词预览**: 显示前100个字符
- **状态**: 显示启用/禁用状态
- **类型**: 显示默认/自定义标签
- **更新时间**: 最后修改时间
- **操作**: 查看、编辑、重置按钮

## 💡 使用技巧

### 1. 提示词优化建议
- **明确指令**: 清楚说明生成要求
- **提供示例**: 给出期望的输出格式
- **使用变量**: 正确使用 `{变量名}` 格式
- **测试验证**: 修改后及时测试效果

### 2. 问题类型选择
- **exact**: 适合标准查询场景
- **fuzzy**: 适合用户输入不完整的情况
- **reverse**: 适合已知联行号查银行的场景
- **natural**: 适合口语化对话场景

### 3. 提供商选择
- **通义千问**: 中文理解能力强，适合中文场景
- **DeepSeek**: 推理能力强，适合复杂逻辑
- **火山引擎**: 性价比高，适合大批量生成

### 4. 批量管理
- 使用Tab快速切换提供商
- 可以为不同提供商设置不同的提示词策略
- 保持同一问题类型的提示词风格一致

## 🔄 与样本生成的关系

### 工作流程
1. 用户在「样本生成」页面选择LLM提供商
2. 系统根据选择的提供商和问题类型查找对应的提示词
3. 如果找到自定义提示词，使用自定义版本
4. 如果没有自定义，使用系统默认提示词
5. 将银行数据填充到提示词变量中
6. 发送给LLM API生成问答对

### 生效时间
- 提示词修改后**立即生效**
- 无需重启服务
- 下次样本生成时自动使用新提示词

## ⚠️ 注意事项

### 1. 权限要求
- 只有**管理员**可以访问此功能
- 普通用户无法查看或修改提示词

### 2. 变量格式
- 必须使用 `{变量名}` 格式
- 变量名区分大小写
- 不支持的变量会导致生成失败

### 3. 默认模板
- 默认模板**不能删除**
- 可以编辑默认模板的内容
- 重置功能会恢复为系统预置值

### 4. 启用状态
- 禁用的提示词不会被使用
- 系统会自动查找启用的提示词
- 如果没有启用的提示词，使用硬编码默认值

### 5. 测试建议
- 修改提示词后，先小批量测试
- 观察生成的问答对质量
- 根据效果调整提示词内容
- 确认无误后再大批量生成

## 🎯 最佳实践

### 1. 提示词编写
```
✅ 好的提示词：
- 结构清晰，分段明确
- 要求具体，易于理解
- 提供示例，格式统一
- 使用变量，灵活替换

❌ 不好的提示词：
- 过于简单，缺少指导
- 要求模糊，难以执行
- 没有示例，格式不明
- 硬编码数据，不灵活
```

### 2. 版本管理
- 修改前先记录原始版本
- 重大修改前先测试
- 保持提示词的一致性
- 定期review和优化

### 3. 效果评估
- 生成后检查问答对质量
- 统计不同提示词的效果
- 根据反馈持续优化
- 分享优秀的提示词模板

## 🆘 常见问题

### Q1: 初始化按钮点击后没反应？
**A**: 检查是否已经初始化过。如果已有模板，系统不会重复创建。

### Q2: 编辑后提示词没有生效？
**A**: 确认提示词状态为"启用"，并且在样本生成时选择了对应的提供商。

### Q3: 变量替换失败？
**A**: 检查变量格式是否正确，必须使用 `{变量名}` 格式，且变量名必须是支持的三个之一。

### Q4: 如何恢复默认提示词？
**A**: 点击「重置」按钮即可恢复为系统默认值。

### Q5: 可以删除提示词吗？
**A**: 默认模板不能删除，自定义模板可以删除。

### Q6: 提示词修改后需要重启服务吗？
**A**: 不需要，修改后立即生效。

## 📞 技术支持

如遇到问题：
1. 检查浏览器控制台是否有错误
2. 查看后端日志 `mvp/backend.log`
3. 运行测试脚本 `python3 test_llm_prompt_management.py`
4. 联系技术支持团队

## 📚 相关文档

- [样本生成功能使用指南](./🎯异步样本生成使用指南.md)
- [三层样本管理测试指南](./🚀三层样本管理测试指南.md)
- [大模型提示词管理实现完成](./✅大模型提示词管理功能实现完成.md)

---

**更新时间**: 2026-02-01  
**版本**: v1.0  
**适用角色**: 系统管理员
