# 🚀 服务启动说明

**启动时间**: 2026-01-11  
**状态**: ✅ 后端服务已成功启动

---

## ✅ 服务状态

### 后端服务（MVP应用）
- **状态**: ✅ 运行中
- **端口**: 8000
- **进程ID**: 4
- **工作目录**: mvp/

### 访问地址
- **API基础地址**: http://localhost:8000
- **健康检查**: http://localhost:8000/health
- **API文档（Swagger）**: http://localhost:8000/docs
- **API文档（ReDoc）**: http://localhost:8000/redoc

---

## 📊 服务验证

### 1. 健康检查测试
```bash
curl http://localhost:8000/health
```

**响应**:
```json
{
    "status": "healthy",
    "app": "Bank Code Retrieval System",
    "version": "1.0.0"
}
```
✅ 健康检查通过

### 2. API文档访问
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

✅ API文档可访问

---

## 🔧 可用的测试工具

### 1. API端点测试脚本
```bash
bash test_api_endpoints.sh
```

这个脚本会测试：
- 健康检查端点
- API文档可访问性
- 认证端点
- 需要认证的端点

### 2. 手动测试命令

#### 健康检查
```bash
curl http://localhost:8000/health
```

#### 查看API文档
在浏览器中打开：
- http://localhost:8000/docs

#### 测试登录（需要确认正确的端点路径）
```bash
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123"
```

---

## 📝 服务日志

### 查看实时日志
服务日志会实时显示在终端中，包括：
- 请求日志
- 数据库操作
- 错误信息
- 系统事件

### 日志位置
- 应用日志: mvp/logs/
- 数据库: mvp/*.db

---

## 🛠️ 服务管理

### 查看服务状态
服务正在后台运行，进程ID: 4

### 停止服务
如需停止服务，可以：
1. 在Kiro中使用进程管理工具
2. 或使用命令: `pkill -f "uvicorn app.main:app"`

### 重启服务
```bash
bash start_backend.sh
```

---

## 🧪 测试建议

### 1. 使用Swagger UI测试
1. 打开浏览器访问: http://localhost:8000/docs
2. 查看所有可用的API端点
3. 使用"Try it out"功能测试各个端点
4. 查看请求和响应示例

### 2. 使用curl测试
```bash
# 健康检查
curl http://localhost:8000/health

# 获取API信息
curl http://localhost:8000/

# 测试其他端点（根据API文档）
curl http://localhost:8000/api/...
```

### 3. 使用Postman或类似工具
- 导入API文档: http://localhost:8000/openapi.json
- 创建测试集合
- 执行自动化测试

---

## 📚 API端点概览

根据MVP应用的结构，主要API端点包括：

### 认证相关
- POST /api/auth/login - 用户登录
- POST /api/auth/register - 用户注册
- POST /api/auth/refresh - 刷新令牌

### 用户管理
- GET /api/users/me - 获取当前用户信息
- PUT /api/users/me - 更新用户信息
- GET /api/users - 获取用户列表（管理员）

### 数据管理
- GET /api/datasets - 获取数据集列表
- POST /api/datasets - 上传数据集
- GET /api/datasets/{id} - 获取数据集详情
- POST /api/datasets/{id}/validate - 验证数据集

### 训练管理
- GET /api/training - 获取训练任务列表
- POST /api/training - 创建训练任务
- GET /api/training/{id} - 获取训练任务详情
- POST /api/training/{id}/start - 启动训练

### 问答服务
- POST /api/query - 提交问答查询
- GET /api/query/history - 获取查询历史

### 系统管理
- GET /health - 健康检查
- GET /api/admin/logs - 查看日志（管理员）

**注意**: 具体的端点路径请参考Swagger文档: http://localhost:8000/docs

---

## ⚠️ 注意事项

### 1. 数据库
- 使用SQLite数据库
- 数据库文件位于: mvp/*.db
- 已有测试数据库文件

### 2. 认证
- 默认管理员账号: admin / admin123
- 需要先创建用户或使用现有账号
- 某些端点需要认证令牌

### 3. 端口占用
- 确保8000端口未被其他服务占用
- 如需更改端口，修改启动命令中的--port参数

### 4. 环境配置
- 环境变量配置在.env文件中
- 大模型API密钥需要配置才能使用训练功能

---

## 🎯 下一步操作

### 1. 验证API功能
- 打开Swagger UI: http://localhost:8000/docs
- 测试各个端点
- 验证认证流程
- 测试数据上传和查询

### 2. 前端集成（可选）
如需启动前端服务：
```bash
cd frontend
npm install
npm start
```

### 3. 功能测试
- 测试用户注册和登录
- 测试数据集上传和验证
- 测试训练任务创建
- 测试问答查询功能

---

## 📞 获取帮助

### 查看日志
服务日志会实时显示，包含详细的请求和错误信息

### API文档
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc
- OpenAPI JSON: http://localhost:8000/openapi.json

### 代码注释
所有核心代码都已添加详细的中文注释，可以直接查看源代码了解实现细节。

---

**服务已就绪，可以开始测试！** 🎉

**访问地址**: http://localhost:8000/docs
