# 🧪 前端智能生成功能 - 测试指南

## 🚀 快速测试

### 步骤 1：启动服务

```bash
# 1. 确保后端运行
./start_with_memory_limit.sh

# 2. 启动前端（新终端）
cd frontend
npm start
```

### 步骤 2：访问页面

打开浏览器访问：`http://localhost:3000`

登录账号：
- 用户名：`testuser`
- 密码：`test123`

### 步骤 3：进入数据管理

点击左侧菜单：**数据管理**

### 步骤 4：上传文件

1. 点击右上角 **"上传数据集"**
2. 点击 **"选择文件"**
3. 选择 `data/T_BANK_LINE_NO_ICBC_ALL.unl`
4. 系统自动启用智能生成模式

### 步骤 5：配置参数

**智能生成训练数据：** ✅ 已开启

**每个银行生成样本数：** 7（默认）

**使用大模型增强：** ❌ 关闭（推荐）

### 步骤 6：开始生成

点击 **"开始生成"** 按钮

等待生成完成（约 30 分钟）

### 步骤 7：查看结果

生成完成后会显示：
- ✅ 成功处理 177,316 个银行
- ✅ 生成 1,241,212 个训练样本
- ✅ 数据集 ID: XX

### 步骤 8：开始训练

点击 **"去训练"** 按钮

在训练页面：
1. 选择刚生成的数据集
2. 配置训练参数
3. 开始训练

## 🧪 小规模测试（推荐先做）

### 创建测试文件

```bash
# 创建包含 100 个银行的测试文件
head -100 data/T_BANK_LINE_NO_ICBC_ALL.unl > test_banks_100.unl
```

### 测试流程

1. 上传 `test_banks_100.unl`
2. 配置：每个银行 5 个样本
3. 点击生成
4. 预期结果：
   - 100 个银行
   - 500 个样本
   - 耗时：< 1 秒

### 验证质量

在数据集列表中：
1. 找到刚生成的数据集
2. 点击 **"预览"**
3. 查看生成的样本
4. 确认问法是否多样化

## 📊 测试检查清单

### 界面测试

- [ ] 上传对话框正常显示
- [ ] 智能生成开关可用
- [ ] 参数配置正常
- [ ] 文件选择正常
- [ ] .unl 文件自动启用智能生成

### 功能测试

- [ ] 文件上传成功
- [ ] 生成进度显示正常
- [ ] 生成完成提示
- [ ] 统计信息正确
- [ ] 数据集创建成功

### 数据测试

- [ ] 样本数量正确
- [ ] 问法多样化
- [ ] 答案格式正确
- [ ] 银行信息准确

### 集成测试

- [ ] 跳转到训练页面
- [ ] 数据集可选择
- [ ] 训练可正常启动
- [ ] 模型训练成功

## 🐛 常见问题

### 问题 1：上传失败

**症状：** 点击"开始生成"后报错

**可能原因：**
- 后端服务未启动
- Token 过期
- 文件格式不正确

**解决方案：**
```bash
# 检查后端服务
curl http://localhost:8000/health

# 重新登录获取新 token
# 检查文件格式
head -5 data/T_BANK_LINE_NO_ICBC_ALL.unl
```

### 问题 2：生成进度卡住

**症状：** 进度条停在某个百分比不动

**可能原因：**
- 后端处理中
- 数据量太大
- 内存不足

**解决方案：**
```bash
# 查看后端日志
tail -f mvp/logs/app_2026-01-21.log

# 查看错误日志
tail -f mvp/logs/error_2026-01-21.log

# 检查进程
ps aux | grep uvicorn
```

### 问题 3：生成失败

**症状：** 显示"生成失败"

**可能原因：**
- 文件格式错误
- 内存溢出
- API 错误

**解决方案：**
```bash
# 查看错误日志
tail -50 mvp/logs/error_2026-01-21.log

# 重启服务
./start_with_memory_limit.sh

# 使用小文件测试
head -100 data/T_BANK_LINE_NO_ICBC_ALL.unl > test.unl
```

### 问题 4：前端无法访问

**症状：** 浏览器无法打开页面

**可能原因：**
- 前端服务未启动
- 端口被占用
- 编译错误

**解决方案：**
```bash
# 检查前端进程
ps aux | grep node

# 重启前端
cd frontend
npm start

# 检查端口
lsof -i :3000
```

## 📝 测试记录模板

```
测试日期：2026-01-21
测试人员：[你的名字]

测试文件：
- [ ] test_banks_100.unl (100 个银行)
- [ ] T_BANK_LINE_NO_ICBC_ALL.unl (177,316 个银行)

测试配置：
- 每个银行样本数：7
- 使用大模型：否

测试结果：
- 上传成功：✅ / ❌
- 生成成功：✅ / ❌
- 样本数量：[实际数量]
- 生成时间：[实际时间]
- 数据集 ID：[ID]

质量检查：
- 问法多样性：✅ / ❌
- 答案准确性：✅ / ❌
- 格式正确性：✅ / ❌

训练测试：
- 数据集可用：✅ / ❌
- 训练启动：✅ / ❌
- 训练完成：✅ / ❌

问题记录：
[记录遇到的问题]

备注：
[其他说明]
```

## 🎯 测试建议

### 1. 分阶段测试

1. **第一阶段：** 小文件测试（100 个银行）
   - 验证功能正常
   - 检查生成质量
   - 确认流程顺畅

2. **第二阶段：** 中等文件测试（1000 个银行）
   - 测试性能
   - 观察内存使用
   - 记录生成时间

3. **第三阶段：** 完整文件测试（177,316 个银行）
   - 生成完整数据集
   - 训练新模型
   - 验证准确率提升

### 2. 质量验证

生成完成后，检查：
- 样本数量是否正确
- 问法是否多样化
- 答案格式是否统一
- 银行信息是否准确

### 3. 性能监控

测试过程中监控：
- CPU 使用率
- 内存使用量
- 磁盘 I/O
- 网络延迟

### 4. 错误处理

测试各种错误情况：
- 上传错误文件
- 中断生成过程
- 网络断开
- 服务重启

## ✅ 测试完成标准

- [ ] 小规模测试通过
- [ ] 中规模测试通过
- [ ] 完整数据集生成成功
- [ ] 样本质量验证通过
- [ ] 训练流程验证通过
- [ ] 准确率提升验证
- [ ] 性能指标达标
- [ ] 错误处理正常

## 🎉 测试成功！

如果所有测试通过，恭喜你！

**下一步：**
1. 生成完整训练数据集
2. 训练新模型
3. 验证准确率提升
4. 部署到生产环境

---

**准备好开始测试了吗？** 🚀
